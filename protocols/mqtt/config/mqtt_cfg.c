////////////////////////////////////////////////////////////////////////////////
// COPYRIGHT (c) 2023
// NOMNIO d.o.o.
// All rights reserved.
////////////////////////////////////////////////////////////////////////////////
/**
 *	@file		mqtt_cfg.c
 *	@author   	Tibor Sovilj
 *	@date		28.10.2023
 *	@version	V0.0.1

 *	@brief 		Configuration source file for the MQTT protocol.
 */
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
/**
 *  @addtogroup MQTT_CONFIG
 *  @{ <!-- BEGIN GROUP -->
 */
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Includes
////////////////////////////////////////////////////////////////////////////////
#include <stdio.h>
#include "mqtt_cfg.h"
#include "../../drivers/devices/DHT22/lib/DHT22.h"

////////////////////////////////////////////////////////////////////////////////
// CONFIG Variables and Tables
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// CONFIG Functions definitions
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
/**
 * @brief   Function which creates payload string.
 * 
 * @param[out]  payload     Pointer to an external string
 * @param[in]   opmode      Mode of operation enum
 */
////////////////////////////////////////////////////////////////////////////////
void mqtt_get_payload_string(char* payload, mqtt_opmode_e opmode)
{
    switch (opmode)
    {
        case eMQTT_OPERATION_DHT22_INTERVAL_5S:
            sprintf(payload, "INTERVAL_5S\nTemperature: %3.1f\r\nHumidity: %3.1f\r\n", dht22_get_temperature(), dht22_get_humidity());
            break;

        case eMQTT_OPERATION_DHT22_BUTTON_INTERRUPT:
        sprintf(payload, "BUTTON_IT\nTemperature: %3.1f\r\nHumidity: %3.1f\r\n", dht22_get_temperature(), dht22_get_humidity());
            break;

        case eMQTT_OPERATION_DHT22_BROKER_REQUEST:
        sprintf(payload, "BROKER_REQ\nTemperature: %3.1f\r\nHumidity: %3.1f\r\n", dht22_get_temperature(), dht22_get_humidity());
            break;
        
        default:
            printf("ERROR: MQTT OPERATION MODE UNDEFINED\n");
            break;
    }
}
////////////////////////////////////////////////////////////////////////////////
/**
 *  @} <!-- END GROUP -->
 */
////////////////////////////////////////////////////////////////////////////////
